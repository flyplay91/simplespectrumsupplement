{%- layout none -%}{%- include 'LS_83195002989_global' -%}{%- if shop.metafields.langshop['searchCollections'] == "1" -%}{%- assign LS_search_terms = search.terms | downcase | replace: '&amp;', '&' | replace: '&quot;', '"' | replace: "&#39;", "'" -%}{%- assign LS_search_terms_handle = LS_search_terms | handleize | append: "-" | prepend: "-" -%}{%- capture LS_title_meta_key -%}{{ LS_83195002989_lang }}_title{%- endcapture -%}{%- capture LS_description_meta_key -%}{{ LS_83195002989_lang }}_body_html{%- endcapture -%}{%- assign LS_result_count = 0 -%} { "status": "enabled", "items": [ {%- comment -%} Collections search {%- endcomment -%}{%- paginate collections by 10000 -%}{%- for search_collection in collections -%}{%- if search_collection.metafields.langshop[LS_title_meta_key] -%}{%- assign loop_search_collection_title = search_collection.metafields.langshop[LS_title_meta_key] | downcase | strip_html -%}{%- else -%}{%- assign loop_search_collection_title = search_collection.title | downcase | strip_html -%}{%- endif -%}{%- if search_collection.metafields.langshop[LS_description_meta_key] -%}{%- assign loop_search_collection_description = search_collection.metafields.langshop[LS_description_meta_key] | downcase | strip_html -%}{%- else -%}{%- assign loop_search_collection_description = search_collection.description | downcase | strip_html -%}{%- endif -%}{%- assign description_matched = false -%}{%- assign title_matched = false -%}{%- if shop.metafields.langshop['searchDisableDescription'] != "1" -%}{%- assign loop_search_collection_description_handle = loop_search_collection_description | handleize | append: "-" | prepend: "-" -%}{%- if LS_strict_search == "1" and loop_search_collection_description_handle contains LS_search_terms_handle -%}{%- assign description_matched = true -%}{%- endif -%}{%- if LS_strict_search != "1" and loop_search_collection_description contains LS_search_terms -%}{%- assign description_matched = true -%}{%- endif -%}{%- endif -%}{%- if shop.metafields.langshop['searchDisableTitle'] != "1" -%}{%- assign loop_search_collection_title_handle = loop_search_collection_title | handleize | append: "-" | prepend: "-" -%}{%- if LS_strict_search == "1" and loop_search_collection_title_handle contains LS_search_terms_handle -%}{%- assign title_matched = true -%}{%- endif -%}{%- if LS_strict_search != "1" and loop_search_collection_title contains LS_search_terms -%}{%- assign title_matched = true -%}{%- endif -%}{%- endif -%}{%- if title_matched or description_matched -%}{%- if LS_result_count > 0 -%},{%- endif -%} { "item": {{ search_collection | json }}, "title": {{ loop_search_collection_title | strip_newlines | json }}, "description": {{ loop_search_collection_description | strip_newlines | json }} } {%- assign LS_result_count = LS_result_count | plus: 1 -%}{%- endif -%}{%- endfor -%}{%- endpaginate -%} ] }{%- else -%} { "status": "disabled" }{%- endif -%}